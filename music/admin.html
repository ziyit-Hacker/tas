<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>éŸ³ä¹ç®¡ç†ç³»ç»Ÿ - ç®¡ç†å‘˜åå°</title>
    <link rel="icon" href="../assets/ziyit.png" type="image/x-icon">
    <script src="../assets/f12check.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --text-color: #333;
            --border-color: #bdc3c7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            cursor: default !important;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text-color);
        }

        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* å¤´éƒ¨å¯¼èˆª */
        .admin-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .admin-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-title::before {
            content: "ğŸµ";
            font-size: 32px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            background: var(--light-color);
            padding: 8px 15px;
            border-radius: 25px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .header-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--accent-color), #2980b9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .admin-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .sidebar-menu {
            list-style: none;
        }

        .menu-item {
            padding: 12px 15px;
            margin: 5px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .menu-item:hover,
        .menu-item.active {
            background: var(--accent-color);
            color: white;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* å†…å®¹åŒºåŸŸæ ·å¼ */
        .content-section {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .content-section.active {
            display: block;
        }

        .section-header {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* ç”¨æˆ·ç®¡ç†æ ·å¼ */
        .user-management {
            max-height: 600px;
            overflow-y: auto;
        }

        .user-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .user-search {
            flex: 1;
            min-width: 300px;
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 25px;
            outline: none;
            font-size: 14px;
        }

        .user-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .user-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .user-btn.danger {
            background: var(--danger-color);
        }

        .user-btn.danger:hover {
            background: #c0392b;
        }

        .user-btn.success {
            background: var(--success-color);
        }

        .user-btn.success:hover {
            background: #229954;
        }

        .user-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .user-stat-card {
            background: var(--light-color);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .user-stat-number {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 5px;
        }

        .user-stat-label {
            font-size: 14px;
            color: var(--secondary-color);
        }

        .user-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .user-item {
            display: grid;
            grid-template-columns: 50px 1fr 120px 100px 100px 100px;
            gap: 15px;
            align-items: center;
            padding: 15px;
            margin: 8px 0;
            background: var(--light-color);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .user-item:hover {
            background: #d5dbdb;
            transform: translateX(5px);
        }

        .user-avatar-small {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .user-type {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            background: var(--accent-color);
            color: white;
            display: inline-block;
        }

        .user-type.ur {
            background: var(--warning-color);
        }

        .user-type.zc {
            background: var(--success-color);
        }

        .user-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            background: var(--success-color);
            color: white;
        }

        .user-status.offline {
            background: var(--danger-color);
        }

        .user-actions {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: #2980b9;
        }

        .action-btn.edit {
            background: var(--warning-color);
        }

        .action-btn.edit:hover {
            background: #e67e22;
        }

        .action-btn.delete {
            background: var(--danger-color);
        }

        .action-btn.delete:hover {
            background: #c0392b;
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 500px;
            max-width: 90%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--secondary-color);
        }

        .form-input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            outline: none;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            border-color: var(--accent-color);
        }

        .form-select {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            outline: none;
            font-size: 14px;
            background: white;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        /* éŸ³ä¹æ’­æ”¾å™¨ */
        .music-player-admin {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .player-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .player-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }

        .control-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: #2980b9;
            transform: scale(1.1);
        }

        .progress-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .time-display {
            font-size: 14px;
            color: var(--secondary-color);
            min-width: 50px;
            font-family: monospace;
        }

        .progress-bar {
            flex: 1;
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
            cursor: pointer;
        }

        .progress {
            height: 100%;
            background: var(--accent-color);
            width: 0%;
            transition: width 0.1s;
        }

        /* æ­Œè¯æ˜¾ç¤ºåŒºåŸŸ */
        .lyrics-admin {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-height: 400px;
            overflow-y: auto;
        }

        .lyrics-header {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .lyrics-content {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.8;
            color: var(--text-color);
            white-space: pre-wrap;
            background: var(--light-color);
            padding: 20px;
            border-radius: 10px;
            max-height: 300px;
            overflow-y: auto;
        }

        /* éŸ³ä¹åˆ—è¡¨ */
        .music-list-admin {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .search-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .search-input {
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 25px;
            outline: none;
            width: 300px;
            font-size: 14px;
        }

        .search-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .music-items {
            max-height: 400px;
            overflow-y: auto;
        }

        .music-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 8px 0;
            background: var(--light-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .music-item:hover {
            background: #d5dbdb;
            transform: translateX(5px);
        }

        .music-item.playing {
            background: var(--accent-color);
            color: white;
            border-left-color: var(--success-color);
        }

        .music-info {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .music-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .music-details {
            font-size: 12px;
            color: #7f8c8d;
        }

        .music-item.playing .music-details {
            color: rgba(255, 255, 255, 0.8);
        }

        /* ç³»ç»Ÿä¿¡æ¯ */
        .system-info {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-top: 20px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: var(--light-color);
            border-radius: 8px;
        }

        .info-label {
            font-weight: 600;
            color: var(--secondary-color);
        }

        .info-value {
            font-family: monospace;
            color: var(--accent-color);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .admin-content {
                grid-template-columns: 1fr;
            }

            .sidebar {
                order: 2;
            }

            .search-input {
                width: 200px;
            }

            .user-item {
                grid-template-columns: 40px 1fr 100px 80px 80px 80px;
                gap: 10px;
            }
        }

        @media (max-width: 768px) {
            .header-top {
                flex-direction: column;
                gap: 15px;
            }

            .header-stats {
                grid-template-columns: 1fr;
            }

            .search-input {
                width: 100%;
            }

            .player-controls {
                flex-wrap: wrap;
            }

            .user-controls {
                flex-direction: column;
            }

            .user-search {
                min-width: 100%;
            }

            .user-item {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .user-actions {
                justify-content: center;
            }
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #2980b9;
        }

        .user-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            background: var(--success-color);
            color: white;
        }

        .user-status.offline {
            background: var(--danger-color);
        }

        .user-status.blacklisted {
            background: var(--danger-color);
        }

        .user-status.safe {
            background: var(--success-color);
        }

        .user-status.ztg {
            background: #9b59b6;
            /* ç´«è‰²è¡¨ç¤ºZTGç”¨æˆ· */
        }

        /* LRCè½¬æ¢åŠŸèƒ½æ ·å¼ */
        .lrc-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: auto;
        }

        .lrc-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .lrc-btn:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .lrc-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        .lrc-status {
            font-size: 12px;
            color: var(--secondary-color);
            padding: 4px 8px;
            border-radius: 10px;
            background: var(--light-color);
        }

        .lrc-conversion-panel {
            background: var(--light-color);
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            border: 1px solid var(--border-color);
        }

        .lrc-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .lrc-panel-header h3 {
            margin: 0;
            color: var(--accent-color);
        }

        .lrc-progress {
            display: flex;
            gap: 20px;
            font-size: 14px;
            color: var(--secondary-color);
        }

        .lrc-control-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
        }

        .lrc-action-btn {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .lrc-action-btn:hover {
            background: #229954;
            transform: translateY(-2px);
        }

        .lrc-action-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        .lrc-preview h4 {
            margin: 0 0 10px 0;
            color: var(--accent-color);
        }

        #lrc-preview-content {
            width: 100%;
            height: 150px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            resize: vertical;
            background: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="admin-container">
        <!-- å¤´éƒ¨å¯¼èˆª -->
        <header class="admin-header">
            <div class="header-top">
                <h1 class="admin-title">éŸ³ä¹ç®¡ç†ç³»ç»Ÿ</h1>
                <div class="user-info">
                    <div class="user-avatar">AD</div>
                    <div>
                        <div class="user-name">ç®¡ç†å‘˜</div>
                        <div class="user-role" id="user-role">ç³»ç»Ÿç®¡ç†å‘˜</div>
                    </div>
                </div>
            </div>
            <div class="header-stats">
                <div class="stat-card">
                    <div class="stat-number" id="total-songs">0</div>
                    <div class="stat-label">æ€»æ­Œæ›²æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="playing-song">-</div>
                    <div class="stat-label">å½“å‰æ’­æ”¾</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="online-users">1</div>
                    <div class="stat-label">åœ¨çº¿ç”¨æˆ·</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="system-status">æ­£å¸¸</div>
                    <div class="stat-label">ç³»ç»ŸçŠ¶æ€</div>
                </div>
            </div>
        </header>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <div class="admin-content">
            <!-- ä¾§è¾¹æ  -->
            <aside class="sidebar">
                <ul class="sidebar-menu">
                    <li class="menu-item active" data-section="music-management">
                        <span>ğŸµ</span> éŸ³ä¹ç®¡ç†
                    </li>
                    <li class="menu-item" data-section="user-management">
                        <span>ğŸ‘¥</span> ç”¨æˆ·ç®¡ç†
                    </li>
                    <li class="menu-item" onclick="window.location.href = '../developers/'">
                        <span>ğŸ“‹</span> æ—¥å¿—æŸ¥çœ‹
                    </li>
                    <li class="menu-item" onclick="window.location.href = './'">
                        <span>ğŸ”™</span> è¿”å›ä¸»é¡µ
                    </li>
                </ul>
            </aside>

            <!-- ä¸»å†…å®¹åŒº -->
            <main class="main-content">
                <!-- éŸ³ä¹ç®¡ç† -->
                <section id="music-management" class="content-section active">
                    <!-- éŸ³ä¹æ’­æ”¾å™¨ -->
                    <section class="music-player-admin">
                        <div class="player-header">
                            <h2 class="player-title">éŸ³ä¹æ’­æ”¾æ§åˆ¶</h2>
                            <div class="player-status" id="player-status">æš‚åœä¸­</div>
                        </div>

                        <div class="player-info">
                            <div class="current-song" id="current-song">è¯·é€‰æ‹©ä¸€é¦–æ­Œæ›²</div>
                        </div>

                        <div class="progress-container">
                            <span class="time-display" id="current-time">00:00</span>
                            <div class="progress-bar">
                                <div class="progress" id="progress"></div>
                            </div>
                            <span class="time-display" id="total-time">00:00</span>
                        </div>

                        <div class="player-controls">
                            <button class="control-btn" id="prev-btn">â—€â—€</button>
                            <button class="control-btn" id="play-btn">â–¶</button>
                            <button class="control-btn" id="next-btn">â–¶â–¶</button>
                        </div>

                        <audio id="audio-player" preload="metadata"></audio>
                    </section>

                    <!-- æ­Œè¯æ˜¾ç¤º -->
                    <section class="lyrics-admin">
                        <div class="lyrics-header">
                            <span>æ­Œè¯å†…å®¹</span>
                            <span class="lyrics-info" id="lyrics-info">æœªåŠ è½½</span>
                            <div class="lrc-controls">
                                <button class="lrc-btn" id="start-lrc-conversion">å¼€å§‹LRCè½¬æ¢</button>
                                <button class="lrc-btn" id="download-lrc" disabled>ä¸‹è½½LRCæ–‡ä»¶</button>
                                <span class="lrc-status" id="lrc-status">å‡†å¤‡å°±ç»ª</span>
                            </div>
                        </div>
                        <div class="lyrics-content" id="lyrics-content">
                            è¯·é€‰æ‹©æ­Œæ›²ä»¥æ˜¾ç¤ºæ­Œè¯å†…å®¹...
                        </div>
                        <div class="lrc-conversion-panel" id="lrc-conversion-panel" style="display: none;">
                            <div class="lrc-panel-header">
                                <h3>LRCæ­Œè¯è½¬æ¢</h3>
                                <div class="lrc-progress">
                                    <span>å½“å‰è¡Œ: <span id="current-line-index">0</span>/<span id="total-lines">0</span></span>
                                    <span>å½“å‰æ—¶é—´: <span id="current-time-display">00:00.00</span></span>
                                </div>
                            </div>
                            <div class="lrc-control-buttons">
                                <button class="lrc-action-btn" id="next-line-btn">ä¸‹ä¸€è¡Œæ­Œè¯</button>
                                <button class="lrc-action-btn" id="reset-lrc-btn">é‡ç½®è½¬æ¢</button>
                            </div>
                            <div class="lrc-preview">
                                <h4>LRCé¢„è§ˆ:</h4>
                                <textarea id="lrc-preview-content" readonly></textarea>
                            </div>
                        </div>
                    </section>

                    <!-- éŸ³ä¹åˆ—è¡¨ -->
                    <section class="music-list-admin">
                        <div class="list-header">
                            <h2>éŸ³ä¹åº“ç®¡ç†</h2>
                            <div class="search-container">
                                <input type="text" class="search-input" id="search-input" placeholder="æœç´¢æ­Œæ›²...">
                                <button class="search-btn" id="search-button">
                                    <svg width="16" height="16" viewBox="0 0 16 16">
                                        <path
                                            d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="music-items" id="music-list">
                            <!-- éŸ³ä¹åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </section>
                </section>

                <!-- ç”¨æˆ·ç®¡ç† -->
                <section id="user-management" class="content-section">
                    <div class="section-header">
                        <h2>ç”¨æˆ·ç®¡ç†</h2>
                        <button class="user-btn success" id="add-user-btn">æ·»åŠ ç”¨æˆ·</button>
                    </div>

                    <div class="user-controls">
                        <input type="text" class="user-search" id="user-search" placeholder="æœç´¢ç”¨æˆ·å...">
                        <button class="user-btn" id="refresh-users">åˆ·æ–°åˆ—è¡¨</button>
                        <button class="user-btn danger" id="export-users">å¯¼å‡ºæ•°æ®</button>
                    </div>

                    <div class="user-stats">
                        <div class="user-stat-card">
                            <div class="user-stat-number" id="total-users">0</div>
                            <div class="user-stat-label">æ€»ç”¨æˆ·æ•°</div>
                        </div>
                        <div class="user-stat-card">
                            <div class="user-stat-number" id="vip-users">0</div>
                            <div class="user-stat-label">VIPç”¨æˆ·</div>
                        </div>
                        <div class="user-stat-card">
                            <div class="user-stat-number" id="normal-users">0</div>
                            <div class="user-stat-label">æ™®é€šç”¨æˆ·</div>
                        </div>
                        <div class="user-stat-card">
                            <div class="user-stat-number" id="online-user-count">1</div>
                            <div class="user-stat-label">åœ¨çº¿ç”¨æˆ·</div>
                        </div>
                        <div class="user-stat-card">
                            <div class="user-stat-number" id="blacklist-users">0</div>
                            <div class="user-stat-label">é»‘åå•ç”¨æˆ·</div>
                        </div>
                    </div>

                    <div class="user-list" id="user-list">
                        <!-- ç”¨æˆ·åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </section>

                <!-- å…¶ä»–åŠŸèƒ½åŒºåŸŸï¼ˆå ä½ï¼‰ -->
                <section id="data-statistics" class="content-section">
                    <div class="section-header">
                        <h2>æ•°æ®ç»Ÿè®¡</h2>
                    </div>
                    <p>æ•°æ®ç»Ÿè®¡åŠŸèƒ½å¼€å‘ä¸­...</p>
                </section>

                <section id="system-settings" class="content-section">
                    <div class="section-header">
                        <h2>ç³»ç»Ÿè®¾ç½®</h2>
                    </div>
                    <p>ç³»ç»Ÿè®¾ç½®åŠŸèƒ½å¼€å‘ä¸­...</p>
                </section>

                <section id="log-viewer" class="content-section">
                    <div class="section-header">
                        <h2>æ—¥å¿—æŸ¥çœ‹</h2>
                    </div>
                    <p>æ—¥å¿—æŸ¥çœ‹åŠŸèƒ½å¼€å‘ä¸­...</p>
                </section>

                <section id="permission-management" class="content-section">
                    <div class="section-header">
                        <h2>æƒé™ç®¡ç†</h2>
                    </div>
                    <p>æƒé™ç®¡ç†åŠŸèƒ½å¼€å‘ä¸­...</p>
                </section>
            </main>
        </div>

        <!-- ç³»ç»Ÿä¿¡æ¯ -->
        <footer class="system-info">
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">æœåŠ¡å™¨æ—¶é—´:</span>
                    <span class="info-value" id="server-time">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å†…å­˜ä½¿ç”¨:</span>
                    <span class="info-value" id="memory-usage">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">CPUè´Ÿè½½:</span>
                    <span class="info-value" id="cpu-load">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">æœ€åæ›´æ–°:</span>
                    <span class="info-value" id="last-update">-</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- ç”¨æˆ·ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div class="modal" id="user-modal">
        <div class="modal-content">
            <div class="modal-header" id="modal-title">ç¼–è¾‘ç”¨æˆ·</div>
            <form id="user-form">
                <div class="form-group">
                    <label class="form-label">ç”¨æˆ·å</label>
                    <input type="text" class="form-input" id="edit-username" required>
                </div>
                <div class="form-group">
                    <label class="form-label">å¯†ç </label>
                    <input type="password" class="form-input" id="edit-password" placeholder="ç•™ç©ºåˆ™ä¸ä¿®æ”¹">
                </div>
                <div class="form-group">
                    <label class="form-label">ç”¨æˆ·ç±»å‹</label>
                    <select class="form-select" id="edit-usertype" required>
                        <option value="UR">æ™®é€šç”¨æˆ·</option>
                        <option value="ZC">VIPç”¨æˆ·</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">ZTGç”¨æˆ·</label>
                    <select class="form-select" id="edit-ztg" required>
                        <option value="False">å¦</option>
                        <option value="True">æ˜¯</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="user-btn danger" id="cancel-edit">å–æ¶ˆ</button>
                    <button type="submit" class="user-btn success">ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // èœå•åˆ‡æ¢åŠŸèƒ½
            function switchSection(sectionId) {
                // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // æ˜¾ç¤ºé€‰ä¸­çš„å†…å®¹åŒºåŸŸ
                document.getElementById(sectionId).classList.add('active');
                
                // æ›´æ–°èœå•é¡¹activeçŠ¶æ€
                document.querySelectorAll('.menu-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
            }

            // éŸ³ä¹ç®¡ç†èœå•ç‚¹å‡»
            document.querySelector('[data-section="music-management"]').addEventListener('click', function () {
                switchSection('music-management');
                updateSystemInfo('åˆ‡æ¢åˆ°éŸ³ä¹ç®¡ç†');
            });

            // ç”¨æˆ·ç®¡ç†èœå•ç‚¹å‡»
            document.querySelector('[data-section="user-management"]').addEventListener('click', function () {
                // åˆ‡æ¢åˆ°ç”¨æˆ·ç®¡ç†é¡µé¢
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById('user-management').classList.add('active');

                // æ›´æ–°èœå•é¡¹activeçŠ¶æ€
                document.querySelectorAll('.menu-item').forEach(item => {
                    item.classList.remove('active');
                });
                this.classList.add('active');

                // åŠ è½½é»‘åå•æ•°æ®
                loadBlacklist();

                // åŠ è½½ç”¨æˆ·æ•°æ®
                loadUsers();
            });

            // æ·»åŠ ç”¨æˆ·æŒ‰é’®
            document.getElementById('add-user-btn').addEventListener('click', addUser);

            // åˆ·æ–°ç”¨æˆ·åˆ—è¡¨
            document.getElementById('refresh-users').addEventListener('click', function () {
                loadUsers();
                updateSystemInfo('ç”¨æˆ·åˆ—è¡¨å·²åˆ·æ–°');
            });

            // æœç´¢ç”¨æˆ·
            document.getElementById('user-search').addEventListener('input', searchUsers);

            // å¯¼å‡ºç”¨æˆ·æ•°æ®
            document.getElementById('export-users').addEventListener('click', exportUsers);

            // æ¨¡æ€æ¡†å¤–éƒ¨ç‚¹å‡»å…³é—­
            document.getElementById('user-modal').addEventListener('click', function (e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });
    </script>

    <script>
        // æƒé™æ£€æŸ¥
        function checkUserPermission() {
            const authToken = localStorage.getItem('authToken');
            if (!authToken) {
                alert('è¯·å…ˆç™»å½•ä»¥è®¿é—®ç®¡ç†å‘˜é¡µé¢');
                window.location.href = './';
                return;
            }

            const [typeCode] = authToken.split('-');
            if (typeCode === 'UR') {
                alert('æ‚¨æ²¡æœ‰æƒé™è®¿é—®ç®¡ç†å‘˜é¡µé¢');
                window.location.href = './';
            }

            // æ˜¾ç¤ºç”¨æˆ·è§’è‰²
            const userRole = document.getElementById('user-role');
            if (typeCode === 'AD') {
                userRole.textContent = 'ç³»ç»Ÿç®¡ç†å‘˜';
            } else if (typeCode === 'ZC') {
                userRole.textContent = 'VIPç”¨æˆ·';
            }
        }

        // éŸ³ä¹æ’­æ”¾å™¨åŠŸèƒ½
        let currentMusicIndex = -1;
        let musicList = [];
        let isPlaying = false;

        const audioPlayer = document.getElementById('audio-player');
        const playBtn = document.getElementById('play-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const currentSong = document.getElementById('current-song');
        const playerStatus = document.getElementById('player-status');
        const progress = document.getElementById('progress');
        const musicListElement = document.getElementById('music-list');
        const currentTimeElement = document.getElementById('current-time');
        const totalTimeElement = document.getElementById('total-time');
        const lyricsContent = document.getElementById('lyrics-content');
        const lyricsInfo = document.getElementById('lyrics-info');
        const totalSongs = document.getElementById('total-songs');
        const playingSong = document.getElementById('playing-song');

        // æ ¼å¼åŒ–æ—¶é—´ä¸º MM:SS æ ¼å¼
        function formatTime(seconds) {
            if (isNaN(seconds) || seconds === Infinity) {
                return '00:00';
            }
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        // æ›´æ–°å½“å‰æ—¶é—´å’Œæ€»æ—¶é•¿æ˜¾ç¤º
        function updateTimeDisplay() {
            currentTimeElement.textContent = formatTime(audioPlayer.currentTime);
            totalTimeElement.textContent = formatTime(audioPlayer.duration);
        }

        // åŠ è½½æ­Œè¯
        async function loadLyrics(lyricsPath) {
            if (lyricsPath === '[NO DATA]') {
                lyricsContent.innerHTML = 'æš‚æ— æ­Œè¯æ•°æ®';
                lyricsInfo.textContent = 'æ— æ­Œè¯';
                return;
            }

            try {
                const normalizedPath = lyricsPath.replace(/\\/g, '/');
                const response = await fetch(normalizedPath);
                if (!response.ok) {
                    throw new Error('æ­Œè¯æ–‡ä»¶ä¸å­˜åœ¨');
                }
                const lyricsText = await response.text();

                // ç›´æ¥æ˜¾ç¤ºæ­Œè¯æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹
                lyricsContent.innerHTML = lyricsText;
                lyricsInfo.textContent = 'å·²åŠ è½½';

                // æ›´æ–°ç³»ç»Ÿä¿¡æ¯
                updateSystemInfo('æ­Œè¯åŠ è½½æˆåŠŸ');
            } catch (error) {
                console.error('åŠ è½½æ­Œè¯å¤±è´¥:', error);
                lyricsContent.innerHTML = 'æ­Œè¯åŠ è½½å¤±è´¥';
                lyricsInfo.textContent = 'åŠ è½½å¤±è´¥';
                updateSystemInfo('æ­Œè¯åŠ è½½å¤±è´¥');
            }
        }

        // æ¸²æŸ“éŸ³ä¹åˆ—è¡¨
        function renderMusicList() {
            musicListElement.innerHTML = '';
            musicList.forEach((music, index) => {
                const [name, location, lyricsPath] = music.split(' \\ ');
                const item = document.createElement('div');
                item.className = 'music-item';
                if (index === currentMusicIndex) {
                    item.classList.add('playing');
                }

                item.innerHTML = `
                    <div class="music-info">
                        <div class="music-name">${name}</div>
                        <div class="music-details">${location.split('/').pop()}</div>
                    </div>
                `;

                item.addEventListener('click', () => playMusic(index));
                musicListElement.appendChild(item);
            });

            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            totalSongs.textContent = musicList.length;
        }

        // æ’­æ”¾éŸ³ä¹
        function playMusic(index) {
            if (index < 0 || index >= musicList.length) return;

            const [name, location, lyricsPath] = musicList[index].split(' \\ ');
            audioPlayer.src = location;
            currentMusicIndex = index;
            currentSong.textContent = name;
            playingSong.textContent = name;

            // æ›´æ–°åˆ—è¡¨æ ·å¼
            document.querySelectorAll('.music-item').forEach((item, i) => {
                item.classList.toggle('playing', i === index);
            });

            // é‡ç½®æ—¶é—´æ˜¾ç¤º
            currentTimeElement.textContent = '00:00';
            totalTimeElement.textContent = '00:00';

            // åŠ è½½æ­Œè¯
            loadLyrics(lyricsPath);

            audioPlayer.play();
            isPlaying = true;
            playBtn.textContent = '||';
            playerStatus.textContent = 'æ’­æ”¾ä¸­';

            updateSystemInfo(`æ­£åœ¨æ’­æ”¾: ${name}`);
        }

        // åŠ è½½éŸ³ä¹åˆ—è¡¨
        fetch('music.txt')
            .then(response => response.text())
            .then(data => {
                musicList = data.split('\n').filter(line => line.trim() !== '');
                renderMusicList();
                updateSystemInfo('éŸ³ä¹åˆ—è¡¨åŠ è½½å®Œæˆ');
            })
            .catch(error => {
                console.error('åŠ è½½éŸ³ä¹åˆ—è¡¨å¤±è´¥:', error);
                updateSystemInfo('éŸ³ä¹åˆ—è¡¨åŠ è½½å¤±è´¥');
            });

        // æ’­æ”¾/æš‚åœæ§åˆ¶
        playBtn.addEventListener('click', () => {
            if (currentMusicIndex === -1 && musicList.length > 0) {
                playMusic(0);
                return;
            }

            if (isPlaying) {
                audioPlayer.pause();
                playBtn.textContent = 'â–¶';
                playerStatus.textContent = 'æš‚åœä¸­';
            } else {
                audioPlayer.play();
                playBtn.textContent = '||';
                playerStatus.textContent = 'æ’­æ”¾ä¸­';
            }
            isPlaying = !isPlaying;
        });

        // ä¸Šä¸€é¦–
        prevBtn.addEventListener('click', () => {
            if (musicList.length === 0) return;
            let newIndex = currentMusicIndex - 1;
            if (newIndex < 0) newIndex = musicList.length - 1;
            playMusic(newIndex);
        });

        // ä¸‹ä¸€é¦–
        nextBtn.addEventListener('click', () => {
            if (musicList.length === 0) return;
            let newIndex = currentMusicIndex + 1;
            if (newIndex >= musicList.length) newIndex = 0;
            playMusic(newIndex);
        });

        // æ›´æ–°è¿›åº¦æ¡å’Œæ—¶é—´æ˜¾ç¤º
        audioPlayer.addEventListener('timeupdate', () => {
            const progressPercent = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            progress.style.width = progressPercent + '%';
            updateTimeDisplay();
        });

        // ç‚¹å‡»è¿›åº¦æ¡è·³è½¬
        document.querySelector('.progress-bar').addEventListener('click', (e) => {
            const rect = e.target.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const width = rect.width;
            const duration = audioPlayer.duration;

            if (duration) {
                audioPlayer.currentTime = (clickX / width) * duration;
            }
        });

        // æ­Œæ›²ç»“æŸè‡ªåŠ¨ä¸‹ä¸€é¦–
        audioPlayer.addEventListener('ended', () => {
            nextBtn.click();
        });

        // å½“éŸ³é¢‘å…ƒæ•°æ®åŠ è½½å®Œæˆæ—¶æ›´æ–°æ€»æ—¶é•¿
        audioPlayer.addEventListener('loadedmetadata', () => {
            updateTimeDisplay();
        });

        // æœç´¢åŠŸèƒ½
        document.getElementById('search-button').addEventListener('click', function (e) {
            e.preventDefault();
            const searchInput = document.getElementById('search-input').value.toLowerCase();
            const musicItems = document.querySelectorAll('.music-item');

            musicItems.forEach(item => {
                const musicName = item.querySelector('.music-name').textContent.toLowerCase();
                item.style.display = musicName.includes(searchInput) ? 'flex' : 'none';
            });

            updateSystemInfo(`æœç´¢: ${searchInput}`);
        });

        // ç³»ç»Ÿä¿¡æ¯æ›´æ–°
        function updateSystemInfo(message) {
            const lastUpdate = document.getElementById('last-update');
            const now = new Date();
            lastUpdate.textContent = now.toLocaleTimeString();

            // æ›´æ–°æœåŠ¡å™¨æ—¶é—´
            const serverTime = document.getElementById('server-time');
            serverTime.textContent = now.toLocaleString();

            // æ¨¡æ‹Ÿç³»ç»ŸçŠ¶æ€
            const memoryUsage = document.getElementById('memory-usage');
            const cpuLoad = document.getElementById('cpu-load');

            memoryUsage.textContent = Math.floor(Math.random() * 30 + 20) + '%';
            cpuLoad.textContent = Math.floor(Math.random() * 40 + 10) + '%';

            console.log(`[ç³»ç»Ÿ] ${message}`);
        }

        // åˆå§‹åŒ–ç³»ç»Ÿä¿¡æ¯
        setInterval(() => {
            updateSystemInfo('ç³»ç»Ÿè¿è¡Œæ­£å¸¸');
        }, 5000);

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æƒé™
        document.addEventListener('DOMContentLoaded', () => {
            checkUserPermission();
            updateSystemInfo('ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');
        });
    </script>

    <script>
        // LRCæ­Œè¯è½¬æ¢åŠŸèƒ½
        let lrcConversionActive = false;
        let currentLyricsLines = [];
        let currentLrcIndex = 0;
        let lrcContent = '';

        // å¼€å§‹LRCè½¬æ¢
        document.getElementById('start-lrc-conversion').addEventListener('click', function() {
            const lyricsText = document.getElementById('lyrics-content').textContent;
            
            if (lyricsText === 'è¯·é€‰æ‹©æ­Œæ›²ä»¥æ˜¾ç¤ºæ­Œè¯å†…å®¹...' || lyricsText === 'æš‚æ— æ­Œè¯æ•°æ®' || lyricsText === 'æ­Œè¯åŠ è½½å¤±è´¥') {
                alert('è¯·å…ˆé€‰æ‹©ä¸€é¦–æ­Œæ›²å¹¶åŠ è½½æ­Œè¯');
                return;
            }

            // åˆ†å‰²æ­Œè¯ä¸ºè¡Œ
            currentLyricsLines = lyricsText.split('\n').filter(line => line.trim() !== '');
            
            if (currentLyricsLines.length === 0) {
                alert('æ²¡æœ‰å¯è½¬æ¢çš„æ­Œè¯å†…å®¹');
                return;
            }

            // è¿‡æ»¤æ‰å·²ç»åŒ…å«æ—¶é—´æˆ³çš„è¡Œï¼ˆLRCæ ¼å¼ï¼š[00:00.00]æ­Œè¯å†…å®¹ï¼‰
            const lrcTimeRegex = /^\[\d{2}:\d{2}\.\d{2}\].+/;
            const linesToProcess = currentLyricsLines.filter(line => !lrcTimeRegex.test(line));
            
            if (linesToProcess.length === 0) {
                alert('æ‰€æœ‰æ­Œè¯è¡Œéƒ½å·²ç»åŒ…å«æ—¶é—´æˆ³ï¼Œæ— éœ€è½¬æ¢');
                return;
            }

            lrcConversionActive = true;
            currentLrcIndex = 0;
            lrcContent = '';
            currentLyricsLines = linesToProcess; // åªå¤„ç†éœ€è¦è½¬æ¢çš„è¡Œ
            
            // æ˜¾ç¤ºè½¬æ¢é¢æ¿
            document.getElementById('lrc-conversion-panel').style.display = 'block';
            document.getElementById('current-line-index').textContent = '0';
            document.getElementById('total-lines').textContent = currentLyricsLines.length;
            document.getElementById('lrc-preview-content').value = '';
            document.getElementById('lrc-status').textContent = 'è½¬æ¢è¿›è¡Œä¸­';
            document.getElementById('start-lrc-conversion').disabled = true;
            document.getElementById('download-lrc').disabled = true;
            
            updateSystemInfo(`å¼€å§‹LRCæ­Œè¯è½¬æ¢ï¼Œéœ€è¦å¤„ç†${currentLyricsLines.length}è¡Œæ­Œè¯`);
        });

        // ä¸‹ä¸€è¡Œæ­Œè¯
        document.getElementById('next-line-btn').addEventListener('click', function() {
            if (!lrcConversionActive || currentLrcIndex >= currentLyricsLines.length) return;
            
            // è‡ªåŠ¨è·å–å½“å‰æ’­æ”¾æ—¶é—´
            const currentTime = audioPlayer.currentTime;
            const minutes = Math.floor(currentTime / 60);
            const seconds = Math.floor(currentTime % 60);
            const milliseconds = Math.floor((currentTime % 1) * 100);
            
            const timeString = `[${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${milliseconds.toString().padStart(2, '0')}]`;
            const currentLine = currentLyricsLines[currentLrcIndex];
            
            // æ·»åŠ åˆ°LRCå†…å®¹
            lrcContent += timeString + currentLine + '\n';
            document.getElementById('lrc-preview-content').value = lrcContent;
            
            // æ›´æ–°è¿›åº¦
            currentLrcIndex++;
            document.getElementById('current-line-index').textContent = currentLrcIndex;
            
            // æ£€æŸ¥æ˜¯å¦å®Œæˆ
            if (currentLrcIndex >= currentLyricsLines.length) {
                lrcConversionActive = false;
                document.getElementById('lrc-status').textContent = 'è½¬æ¢å®Œæˆ';
                document.getElementById('download-lrc').disabled = false;
                updateSystemInfo('LRCæ­Œè¯è½¬æ¢å®Œæˆ');
            } else {
                updateSystemInfo(`å·²è½¬æ¢ç¬¬${currentLrcIndex}è¡Œæ­Œè¯ï¼Œæ—¶é—´: ${timeString}`);
            }
        });

        // é‡ç½®è½¬æ¢
        document.getElementById('reset-lrc-btn').addEventListener('click', function() {
            lrcConversionActive = false;
            currentLyricsLines = [];
            currentLrcIndex = 0;
            lrcContent = '';
            
            document.getElementById('lrc-conversion-panel').style.display = 'none';
            document.getElementById('lrc-preview-content').value = '';
            document.getElementById('current-time-display').textContent = '00:00.00';
            document.getElementById('current-line-index').textContent = '0';
            document.getElementById('lrc-status').textContent = 'å‡†å¤‡å°±ç»ª';
            document.getElementById('start-lrc-conversion').disabled = false;
            document.getElementById('download-lrc').disabled = true;
            
            updateSystemInfo('LRCè½¬æ¢å·²é‡ç½®');
        });

                // ä¸‹è½½LRCæ–‡ä»¶
        document.getElementById('download-lrc').addEventListener('click', function() {
            if (lrcContent.trim() === '') {
                alert('æ²¡æœ‰å¯ä¸‹è½½çš„LRCå†…å®¹');
                return;
            }
            
            // è·å–åŸå§‹æ­Œè¯å†…å®¹ï¼ŒåŒ…å«å·²ç»å­˜åœ¨çš„æ—¶é—´æˆ³è¡Œ
            const originalLyricsText = document.getElementById('lyrics-content').textContent;
            const originalLines = originalLyricsText.split('\n').filter(line => line.trim() !== '');
            
            // åˆ†ç¦»å·²ç»åŒ…å«æ—¶é—´æˆ³çš„è¡Œå’Œéœ€è¦è½¬æ¢çš„è¡Œ
            const lrcTimeRegex = /^\[\d{2}:\d{2}\.\d{2}\].+/;
            const existingLrcLines = originalLines.filter(line => lrcTimeRegex.test(line));
            const finalLrcContent = existingLrcLines.join('\n') + '\n' + lrcContent;
            
            const currentSongName = document.getElementById('current-song').textContent;
            const fileName = currentSongName + '.lrc';
            
            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const blob = new Blob([finalLrcContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            updateSystemInfo(`å·²ä¸‹è½½LRCæ–‡ä»¶: ${fileName}`);
        });

        // ä¿®æ”¹æ­Œè¯åŠ è½½å‡½æ•°ï¼Œåœ¨åŠ è½½æ­Œè¯æ—¶é‡ç½®LRCè½¬æ¢çŠ¶æ€
        const originalLoadLyrics = loadLyrics;
        loadLyrics = async function(lyricsPath) {
            await originalLoadLyrics(lyricsPath);
            
            // é‡ç½®LRCè½¬æ¢çŠ¶æ€
            lrcConversionActive = false;
            document.getElementById('lrc-conversion-panel').style.display = 'none';
            document.getElementById('lrc-status').textContent = 'å‡†å¤‡å°±ç»ª';
            document.getElementById('start-lrc-conversion').disabled = false;
            document.getElementById('download-lrc').disabled = true;
        };
    </script>

    <script>
        // ç”¨æˆ·ç®¡ç†åŠŸèƒ½
        let userList = [];
        let editingUserIndex = -1;

        // ç”¨æˆ·æ–‡ä»¶è·¯å¾„
        const USER_FILE_PATH = '../user/user.txt';

        // æ·»åŠ ç”¨æˆ·
        function addUser() {
            editingUserIndex = -1;
            document.getElementById('modal-title').textContent = 'æ·»åŠ ç”¨æˆ·';
            document.getElementById('user-form').reset();
            document.getElementById('user-modal').classList.add('active');
        }

        // åˆ é™¤ç”¨æˆ·
        function deleteUser(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç”¨æˆ·å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                userList.splice(index, 1);
                saveUsers();
                renderUserList();
                updateUserStats();
                updateSystemInfo('ç”¨æˆ·åˆ é™¤æˆåŠŸ');
            }
        }

        // åŠ è½½ç”¨æˆ·æ•°æ®
        async function loadUsers() {
            try {
                const response = await fetch(USER_FILE_PATH);
                if (!response.ok) {
                    throw new Error('ç”¨æˆ·æ–‡ä»¶ä¸å­˜åœ¨');
                }
                const data = await response.text();
                // ä¿®å¤ï¼šæ­£ç¡®å¤„ç†æ¯ä¸€è¡Œæ•°æ®ï¼Œå»é™¤ç©ºè¡Œå’Œæ¢è¡Œç¬¦
                userList = data.split('\n')
                    .map(line => line.trim())
                    .filter(line => line !== '');
                renderUserList();
                updateUserStats();
                updateSystemInfo('ç”¨æˆ·æ•°æ®åŠ è½½æˆåŠŸ');
            } catch (error) {
                console.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥:', error);
                userList = [];
                renderUserList();
                updateUserStats();
                updateSystemInfo('ç”¨æˆ·æ•°æ®åŠ è½½å¤±è´¥');
            }
        }

        // ä¿å­˜ç”¨æˆ·æ•°æ®
        async function saveUsers() {
            try {
                // è¿™é‡Œéœ€è¦å®ç°æ–‡ä»¶ä¿å­˜é€»è¾‘
                // ç”±äºæµè§ˆå™¨å®‰å…¨é™åˆ¶ï¼Œæ— æ³•ç›´æ¥å†™å…¥æ–‡ä»¶
                // å¯ä»¥æ˜¾ç¤ºä¿å­˜æˆåŠŸä¿¡æ¯ï¼Œå®é™…ä¿å­˜éœ€è¦åç«¯æ”¯æŒ
                updateSystemInfo('ç”¨æˆ·æ•°æ®å·²æ›´æ–°ï¼ˆéœ€è¦åç«¯æ”¯æŒå®é™…ä¿å­˜ï¼‰');
            } catch (error) {
                console.error('ä¿å­˜ç”¨æˆ·æ•°æ®å¤±è´¥:', error);
                updateSystemInfo('ç”¨æˆ·æ•°æ®ä¿å­˜å¤±è´¥');
            }
        }

        let blacklist = [];

        // åŠ è½½é»‘åå•æ•°æ®
        async function loadBlacklist() {
            try {
                const response = await fetch('../hmd.txt');
                const data = await response.text();
                blacklist = data.split('\n')
                    .map(line => line.trim())
                    .filter(line => line !== '')
                    .map(user => {
                        const parts = user.split('-');
                        return parts.length >= 2 ? parts[1] : ''; // åªæå–ç”¨æˆ·å
                    })
                    .filter(username => username !== '');
                console.log('é»‘åå•æ•°æ®åŠ è½½æˆåŠŸ:', blacklist);
                return true;
            } catch (error) {
                console.error('åŠ è½½é»‘åå•æ•°æ®å¤±è´¥:', error);
                blacklist = [];
                return false;
            }
        }

        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åœ¨é»‘åå•å†…
        function isUserInBlacklist(username) {
            return blacklist.includes(username);
        }

        // æ¸²æŸ“ç”¨æˆ·åˆ—è¡¨
        function renderUserList() {
            const userListElement = document.getElementById('user-list');
            userListElement.innerHTML = '';

            // ä½¿ç”¨forå¾ªç¯éå†ç”¨æˆ·æ•°æ®
            for (let i = 0; i < userList.length; i++) {
                const user = userList[i];

                // ä½¿ç”¨user.htmlä¸­çš„æ–¹æ³•ï¼šç›´æ¥split('-')è·å–æ‰€æœ‰éƒ¨åˆ†
                const parts = user.split('-');
                if (parts.length < 4) {
                    console.warn('ç”¨æˆ·æ•°æ®æ ¼å¼é”™è¯¯:', user);
                    continue; // è·³è¿‡æ ¼å¼é”™è¯¯çš„ç”¨æˆ·æ•°æ®
                }

                // ä½¿ç”¨user.htmlä¸­çš„æ–¹æ³•ï¼šç›´æ¥è·å–å„éƒ¨åˆ†
                const type = parts[0];        // ç”¨æˆ·ç±»å‹
                const username = parts[1];     // ç”¨æˆ·å
                const password = parts[2];    // å¯†ç 
                const ifZTG = parts[3];       // ZTGçŠ¶æ€

                // ä¿®å¤ï¼šæ­£ç¡®å¤„ç†ZTGçŠ¶æ€ï¼ŒåŒ…æ‹¬å¯èƒ½çš„æ¢è¡Œç¬¦
                const isZTG = ifZTG.trim() === 'True';
                const isBlacklisted = isUserInBlacklist(username);

                const item = document.createElement('div');
                item.className = 'user-item';

                item.innerHTML = `
                    <div class="user-avatar-small">${username.charAt(0).toUpperCase()}</div>
                    <div class="user-details">
                        <div class="user-name">${username}</div>
                        <div class="user-type ${type.toLowerCase()}">${type === 'ZC' ? 'VIPç”¨æˆ·' : 'æ™®é€šç”¨æˆ·'}</div>
                    </div>
                    <div class="user-status ${isZTG ? 'ztg' : ''}">${isZTG ? 'ZTGç”¨æˆ·' : 'æ™®é€šç”¨æˆ·'}</div>
                    <div class="user-status ${isBlacklisted ? 'blacklisted' : 'safe'}">${isBlacklisted ? 'é»‘åå•' : 'æ­£å¸¸'}</div>
                    <div class="user-actions">
                        <button class="action-btn edit" onclick="editUser(${i})">ç¼–è¾‘</button>
                        <button class="action-btn delete" onclick="deleteUser(${i})">åˆ é™¤</button>
                    </div>
                `;

                userListElement.appendChild(item);
            }
        }

        // æ›´æ–°ç”¨æˆ·ç»Ÿè®¡ä¿¡æ¯
        function updateUserStats() {
            const totalUsers = userList.length;
            const vipUsers = userList.filter(user => user.startsWith('ZC-')).length;
            const normalUsers = userList.filter(user => user.startsWith('UR-')).length;
            // ä¿®å¤ï¼šæ­£ç¡®ç»Ÿè®¡ZTGç”¨æˆ·æ•°é‡
            const ztgUsers = userList.filter(user => {
                const parts = user.split('-');
                return parts.length >= 4 && parts[3].trim() === 'True';
            }).length;
            
            // ç»Ÿè®¡é»‘åå•ç”¨æˆ·æ•°é‡
            const blacklistedUsers = userList.filter(user => {
                const parts = user.split('-');
                return parts.length >= 2 && isUserInBlacklist(parts[1]);
            }).length;

            document.getElementById('total-users').textContent = totalUsers;
            document.getElementById('vip-users').textContent = vipUsers;
            document.getElementById('normal-users').textContent = normalUsers;
            document.getElementById('online-user-count').textContent = ztgUsers;
            
            // æ·»åŠ é»‘åå•ç”¨æˆ·ç»Ÿè®¡æ˜¾ç¤º
            const blacklistElement = document.getElementById('blacklist-users');
            if (blacklistElement) {
                blacklistElement.textContent = blacklistedUsers;
            }
        }

        // ç¼–è¾‘ç”¨æˆ·
        function editUser(index) {
            editingUserIndex = index;
            const user = userList[index];
            const parts = user.split('-');
            if (parts.length < 4) {
                console.error('ç”¨æˆ·æ•°æ®æ ¼å¼é”™è¯¯ï¼Œæ— æ³•ç¼–è¾‘:', user);
                return;
            }

            // ä½¿ç”¨user.htmlä¸­çš„æ–¹æ³•ï¼šç›´æ¥è·å–å„éƒ¨åˆ†
            const type = parts[0];        // ç”¨æˆ·ç±»å‹
            const username = parts[1];    // ç”¨æˆ·å
            const password = parts[2];    // å¯†ç 
            const ifZTG = parts[3];      // ZTGçŠ¶æ€

            document.getElementById('modal-title').textContent = 'ç¼–è¾‘ç”¨æˆ·';
            document.getElementById('edit-username').value = username;
            document.getElementById('edit-usertype').value = type;
            document.getElementById('edit-ztg').value = ifZTG;
            document.getElementById('edit-password').value = '';
            document.getElementById('user-modal').classList.add('active');
        }

        // æœç´¢ç”¨æˆ·
        function searchUsers() {
            const searchTerm = document.getElementById('user-search').value.toLowerCase();
            const userItems = document.querySelectorAll('.user-item');

            userItems.forEach(item => {
                const userName = item.querySelector('.user-name').textContent.toLowerCase();
                item.style.display = userName.includes(searchTerm) ? 'grid' : 'none';
            });

            updateSystemInfo(`æœç´¢ç”¨æˆ·: ${searchTerm}`);
        }

        // å¯¼å‡ºç”¨æˆ·æ•°æ®
        function exportUsers() {
            const data = userList.join('\n');
            const blob = new Blob([data], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'users_export.txt';
            a.click();
            URL.revokeObjectURL(url);
            updateSystemInfo('ç”¨æˆ·æ•°æ®å¯¼å‡ºæˆåŠŸ');
        }

        // ç”¨æˆ·è¡¨å•æäº¤
        document.getElementById('user-form').addEventListener('submit', function (e) {
            e.preventDefault();

            const username = document.getElementById('edit-username').value.trim();
            const password = document.getElementById('edit-password').value;
            const usertype = document.getElementById('edit-usertype').value;
            const ztg = document.getElementById('edit-ztg').value;

            if (!username) {
                alert('è¯·è¾“å…¥ç”¨æˆ·å');
                return;
            }

            // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨ï¼ˆç¼–è¾‘æ—¶æ’é™¤å½“å‰ç”¨æˆ·ï¼‰
            const existingIndex = userList.findIndex((user, index) => {
                const [_, existingUsername] = user.split('-');
                return existingUsername === username && index !== editingUserIndex;
            });

            if (existingIndex !== -1) {
                alert('ç”¨æˆ·åå·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–ç”¨æˆ·å');
                return;
            }

            // æ„å»ºç”¨æˆ·æ•°æ®è¡Œ
            let userData = `${usertype}-${username}`;

            // å¦‚æœæœ‰æ–°å¯†ç ï¼Œä½¿ç”¨æ–°å¯†ç ï¼Œå¦åˆ™ä¿æŒåŸå¯†ç 
            if (password) {
                // è¿™é‡Œåº”è¯¥å¯¹å¯†ç è¿›è¡ŒMD5BASE64åŠ å¯†
                // ç”±äºæµè§ˆå™¨é™åˆ¶ï¼Œè¿™é‡Œä½¿ç”¨ç®€å•å¤„ç†
                userData += `-${btoa(password)}`;
            } else if (editingUserIndex !== -1) {
                // ç¼–è¾‘æ—¶ä¿ç•™åŸå¯†ç 
                const oldUser = userList[editingUserIndex];
                const [_, __, oldPassword] = oldUser.split('-');
                userData += `-${oldPassword}`;
            } else {
                // æ–°å¢ç”¨æˆ·å¿…é¡»è®¾ç½®å¯†ç 
                alert('è¯·è®¾ç½®å¯†ç ');
                return;
            }

            userData += `-${ztg}`;

            if (editingUserIndex === -1) {
                // æ·»åŠ æ–°ç”¨æˆ·
                userList.push(userData);
            } else {
                // æ›´æ–°ç°æœ‰ç”¨æˆ·
                userList[editingUserIndex] = userData;
            }

            saveUsers();
            renderUserList();
            updateUserStats();
            document.getElementById('user-modal').classList.remove('active');

            updateSystemInfo(editingUserIndex === -1 ? 'ç”¨æˆ·æ·»åŠ æˆåŠŸ' : 'ç”¨æˆ·ä¿¡æ¯æ›´æ–°æˆåŠŸ');
        });

        // å–æ¶ˆç¼–è¾‘
        document.getElementById('cancel-edit').addEventListener('click', function () {
            document.getElementById('user-modal').classList.remove('active');
        });

        // ç”¨æˆ·ç®¡ç†ç›¸å…³äº‹ä»¶ç›‘å¬
        document.addEventListener('DOMContentLoaded', function () {
            // ç”¨æˆ·ç®¡ç†èœå•ç‚¹å‡»
            document.querySelector('[data-section="user-management"]').addEventListener('click', function () {
                // åˆ‡æ¢åˆ°ç”¨æˆ·ç®¡ç†é¡µé¢
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById('user-management').classList.add('active');

                // åŠ è½½ç”¨æˆ·æ•°æ®
                loadUsers();
            });

            // æ·»åŠ ç”¨æˆ·æŒ‰é’®
            document.getElementById('add-user-btn').addEventListener('click', addUser);

            // åˆ·æ–°ç”¨æˆ·åˆ—è¡¨
            document.getElementById('refresh-users').addEventListener('click', function () {
                loadUsers();
                updateSystemInfo('ç”¨æˆ·åˆ—è¡¨å·²åˆ·æ–°');
            });

            // æœç´¢ç”¨æˆ·
            document.getElementById('user-search').addEventListener('input', searchUsers);

            // å¯¼å‡ºç”¨æˆ·æ•°æ®
            document.getElementById('export-users').addEventListener('click', exportUsers);

            // æ¨¡æ€æ¡†å¤–éƒ¨ç‚¹å‡»å…³é—­
            document.getElementById('user-modal').addEventListener('click', function (e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // ç³»ç»Ÿä¿¡æ¯æ›´æ–°ï¼ˆè¡¥å……ï¼‰
        function updateSystemInfo(message) {
            const lastUpdate = document.getElementById('last-update');
            const now = new Date();
            lastUpdate.textContent = now.toLocaleTimeString();

            // æ›´æ–°æœåŠ¡å™¨æ—¶é—´
            const serverTime = document.getElementById('server-time');
            serverTime.textContent = now.toLocaleString();

            // æ¨¡æ‹Ÿç³»ç»ŸçŠ¶æ€
            const memoryUsage = document.getElementById('memory-usage');
            const cpuLoad = document.getElementById('cpu-load');

            memoryUsage.textContent = Math.floor(Math.random() * 30 + 20) + '%';
            cpuLoad.textContent = Math.floor(Math.random() * 40 + 10) + '%';

            console.log(`[ç³»ç»Ÿ] ${message}`);
        }
    </script>
</body>

</html>